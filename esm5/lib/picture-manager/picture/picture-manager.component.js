import { Component, Input, Output, EventEmitter } from '@angular/core';
import { HttpClient } from '@angular/common/http';
var PictureManagerComponent = /** @class */ (function () {
    function PictureManagerComponent(httpClient) {
        this.httpClient = httpClient;
        this.showDeleteOption = true;
        /**
         * Outputs
         * @param uploadChange: updates the image and returns the url for it.
         */
        this.uploadChange = new EventEmitter();
        this.response = new EventEmitter();
        this.drag_and_drop = false;
    }
    PictureManagerComponent.prototype.ngOnInit = function () {
        this.settingDefaultValues();
    };
    PictureManagerComponent.prototype.dragAndDropStyles = function (drag_and_drop) {
        this.drag_and_drop = drag_and_drop;
    };
    PictureManagerComponent.prototype.showPreview = function (image) {
        this.source = image;
        this.deleteUrl = this.deleteUrl || this.source;
        this.uploadChange.emit({ status_change: 'update', source: this.source });
    };
    PictureManagerComponent.prototype.delete = function () {
        var _this = this;
        var delete_url = this.creatDeleteUrl(this.source);
        this.httpClient.delete(delete_url, {
            headers: this.jamHeaders
        }).subscribe(function (response) {
            _this.uploadChange.emit({ status_change: 'delete', source: _this.source });
        });
    };
    PictureManagerComponent.prototype.settingDefaultValues = function () {
        this.type = this.type || 'square';
        this.deleteUrl = this.deleteUrl || this.source;
        this.uploadUrl = this.uploadUrl || this.source;
    };
    PictureManagerComponent.prototype.creatDeleteUrl = function (source) {
        var img_url_parties = source.split('/');
        var img_name = img_url_parties.pop();
        return this.deleteUrl + img_name;
    };
    PictureManagerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'jam-picture-manager',
                    template: "<jam-upload [uploadUrl]=\"uploadUrl\" (dragAndDropChange)=\"dragAndDropStyles($event)\" (showPreview)=\"showPreview($event)\" mat-icon-button fxLayout=\"row\" fxLayoutAlign=\"center center\"\n    [jamHeaders]=\"jamHeaders\"\n    (response)=\"response.emit($event)\"\n    >\n    <div *ngIf=\"drag_and_drop\" [ngClass]=\"type + '-drag-and-drop-styles'\"></div>\n    <div *ngIf=\"!drag_and_drop\" id=\"picture-manager\" class=\"mouseover\">\n        <div [ngClass]=\"type\" [style.background-image]=\"'url(' + source + ')'\">\n            <div class=\"mouseover-child\">\n                <div class=\"blur\" [style.background-image]=\"'url(' + source + ')'\"></div>\n                <div class=\"overlay\"></div>\n                <div class=\"menu\">\n                    <div fxLayout=\"column\" fxLayoutAlign=\"center center\" fxLayoutGap=\"8px\">\n                        <mat-icon matTooltip=\"Subir imagen\">add_a_photo</mat-icon>\n                        <mat-divider *ngIf=\"showDeleteOption\"></mat-divider>\n                        <jam-delete-confirmation *ngIf=\"showDeleteOption\"\n                            [styled]=\"{ color: 'white' }\"\n                            (delete)=\"delete()\"\n                        ></jam-delete-confirmation>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</jam-upload>\n",
                    styles: ["jam-upload #picture-manager *,jam-upload #picture-manager *>mat-icon{width:auto;height:auto}.square{border-radius:2%;overflow:hidden}.round{border-radius:50%;overflow:hidden}.round-drag-and-drop-styles{background-color:rgba(0,0,0,.05);position:relative;width:180px;height:180px;top:0;left:0;z-index:333;background-image:url(/assets/images/drag_and_drop.png);border-radius:50%}.square-drag-and-drop-styles{background-color:rgba(0,0,0,.05);position:relative;width:180px;height:180px;top:0;left:0;z-index:333;background-image:url(/assets/images/drag_and_drop.png)}jam-upload #picture-manager *>mat-icon{color:#fff;font-size:4.5rem}jam-upload #picture-manager.mouseover:hover{background-color:transparent}jam-upload #picture-manager.mouseover div>.mouseover-child{display:none;-webkit-transition:display .3s;transition:display .3s}jam-upload #picture-manager.mouseover:hover div>.mouseover-child{display:inherit}jam-upload #picture-manager.mouseover:hover div>.mouseover-child .blur{top:0;bottom:0;left:0;right:0;-webkit-filter:blur(10px);-moz-filter:blur(10px);-ms-filter:blur(10px);-o-filter:blur(10px);filter:blur(10px);width:calc(100% + 40px);height:calc(100% + 40px);position:absolute;z-index:1;margin:-20px}jam-upload #picture-manager div mat-divider{width:60%;position:relative;border-color:#fff}jam-upload #picture-manager div{width:180px;height:180px;position:relative;background-size:cover;background-position:center}jam-upload #picture-manager.mouseover div>.mouseover-child .menu{z-index:3;position:absolute;top:0}jam-upload #picture-manager div>div.overlay{top:0;bottom:0;left:0;right:0;width:100%;height:100%;position:absolute;z-index:1;background-color:rgba(0,0,0,.376)}"]
                },] },
    ];
    /** @nocollapse */
    PictureManagerComponent.ctorParameters = function () { return [
        { type: HttpClient }
    ]; };
    PictureManagerComponent.propDecorators = {
        type: [{ type: Input }],
        source: [{ type: Input }],
        deleteUrl: [{ type: Input }],
        uploadUrl: [{ type: Input }],
        showDeleteOption: [{ type: Input }],
        jamHeaders: [{ type: Input }],
        uploadChange: [{ type: Output }],
        response: [{ type: Output }]
    };
    return PictureManagerComponent;
}());
export { PictureManagerComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGljdHVyZS1tYW5hZ2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1qc29uYXBpLW1hdGVyaWFsLyIsInNvdXJjZXMiOlsibGliL3BpY3R1cmUtbWFuYWdlci9waWN0dXJlL3BpY3R1cmUtbWFuYWdlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMvRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFJbEQ7SUFxREksaUNBQTZCLFVBQXNCO1FBQXRCLGVBQVUsR0FBVixVQUFVLENBQVk7UUFabkMscUJBQWdCLEdBQVksSUFBSSxDQUFDO1FBR2pEOzs7V0FHRztRQUNjLGlCQUFZLEdBQUcsSUFBSSxZQUFZLEVBQWUsQ0FBQztRQUMvQyxhQUFRLEdBQUcsSUFBSSxZQUFZLEVBQWdCLENBQUM7UUFFdEQsa0JBQWEsR0FBWSxLQUFLLENBQUM7SUFFZ0IsQ0FBQztJQUVoRCwwQ0FBUSxHQUFmO1FBQ0ksSUFBSSxDQUFDLG9CQUFvQixFQUFFLENBQUM7SUFDaEMsQ0FBQztJQUVNLG1EQUFpQixHQUF4QixVQUF5QixhQUFzQjtRQUMzQyxJQUFJLENBQUMsYUFBYSxHQUFHLGFBQWEsQ0FBQztJQUN2QyxDQUFDO0lBRU0sNkNBQVcsR0FBbEIsVUFBbUIsS0FBYTtRQUM1QixJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQztRQUNwQixJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUMvQyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxFQUFFLGFBQWEsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO0lBQzdFLENBQUM7SUFFTSx3Q0FBTSxHQUFiO1FBQUEsaUJBU0M7UUFSRyxJQUFJLFVBQVUsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNsRCxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUU7WUFDL0IsT0FBTyxFQUFFLElBQUksQ0FBQyxVQUFVO1NBQzNCLENBQUMsQ0FBQyxTQUFTLENBQ1IsVUFBQyxRQUFRO1lBQ0wsS0FBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsRUFBRSxhQUFhLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxLQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUM3RSxDQUFDLENBQ0osQ0FBQztJQUNOLENBQUM7SUFFTyxzREFBb0IsR0FBNUI7UUFDSSxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLElBQUksUUFBUSxDQUFDO1FBQ2xDLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDO1FBQy9DLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFNBQVMsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQ25ELENBQUM7SUFFTyxnREFBYyxHQUF0QixVQUF1QixNQUFjO1FBQ2pDLElBQUksZUFBZSxHQUFrQixNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3ZELElBQUksUUFBUSxHQUFXLGVBQWUsQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUU3QyxPQUFPLElBQUksQ0FBQyxTQUFTLEdBQUcsUUFBUSxDQUFDO0lBQ3JDLENBQUM7O2dCQTNGSixTQUFTLFNBQUM7b0JBQ1AsUUFBUSxFQUFFLHFCQUFxQjtvQkFDL0IsUUFBUSxFQUFFLDYxQ0F3QmI7b0JBQ0csTUFBTSxFQUFFLENBQUMsbXBEQUFtcEQsQ0FBQztpQkFDaHFEOzs7O2dCQWhDUSxVQUFVOzs7dUJBeUNkLEtBQUs7eUJBQ0wsS0FBSzs0QkFDTCxLQUFLOzRCQUNMLEtBQUs7bUNBQ0wsS0FBSzs2QkFDTCxLQUFLOytCQU1MLE1BQU07MkJBQ04sTUFBTTs7SUEyQ1gsOEJBQUM7Q0FBQSxBQTVGRCxJQTRGQztTQS9EWSx1QkFBdUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgSW1hZ2VDaGFuZ2UgfSBmcm9tICcuL2ltYWdlLWNoYW5nZS1pbnRlcmZhY2UnO1xuaW1wb3J0IHsgVXBsb2FkT3V0cHV0IH0gZnJvbSAnbmd4LXVwbG9hZGVyJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdqYW0tcGljdHVyZS1tYW5hZ2VyJyxcbiAgICB0ZW1wbGF0ZTogYDxqYW0tdXBsb2FkIFt1cGxvYWRVcmxdPVwidXBsb2FkVXJsXCIgKGRyYWdBbmREcm9wQ2hhbmdlKT1cImRyYWdBbmREcm9wU3R5bGVzKCRldmVudClcIiAoc2hvd1ByZXZpZXcpPVwic2hvd1ByZXZpZXcoJGV2ZW50KVwiIG1hdC1pY29uLWJ1dHRvbiBmeExheW91dD1cInJvd1wiIGZ4TGF5b3V0QWxpZ249XCJjZW50ZXIgY2VudGVyXCJcbiAgICBbamFtSGVhZGVyc109XCJqYW1IZWFkZXJzXCJcbiAgICAocmVzcG9uc2UpPVwicmVzcG9uc2UuZW1pdCgkZXZlbnQpXCJcbiAgICA+XG4gICAgPGRpdiAqbmdJZj1cImRyYWdfYW5kX2Ryb3BcIiBbbmdDbGFzc109XCJ0eXBlICsgJy1kcmFnLWFuZC1kcm9wLXN0eWxlcydcIj48L2Rpdj5cbiAgICA8ZGl2ICpuZ0lmPVwiIWRyYWdfYW5kX2Ryb3BcIiBpZD1cInBpY3R1cmUtbWFuYWdlclwiIGNsYXNzPVwibW91c2VvdmVyXCI+XG4gICAgICAgIDxkaXYgW25nQ2xhc3NdPVwidHlwZVwiIFtzdHlsZS5iYWNrZ3JvdW5kLWltYWdlXT1cIid1cmwoJyArIHNvdXJjZSArICcpJ1wiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm1vdXNlb3Zlci1jaGlsZFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJibHVyXCIgW3N0eWxlLmJhY2tncm91bmQtaW1hZ2VdPVwiJ3VybCgnICsgc291cmNlICsgJyknXCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cIm92ZXJsYXlcIj48L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibWVudVwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGZ4TGF5b3V0PVwiY29sdW1uXCIgZnhMYXlvdXRBbGlnbj1cImNlbnRlciBjZW50ZXJcIiBmeExheW91dEdhcD1cIjhweFwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPG1hdC1pY29uIG1hdFRvb2x0aXA9XCJTdWJpciBpbWFnZW5cIj5hZGRfYV9waG90bzwvbWF0LWljb24+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bWF0LWRpdmlkZXIgKm5nSWY9XCJzaG93RGVsZXRlT3B0aW9uXCI+PC9tYXQtZGl2aWRlcj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxqYW0tZGVsZXRlLWNvbmZpcm1hdGlvbiAqbmdJZj1cInNob3dEZWxldGVPcHRpb25cIlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtzdHlsZWRdPVwieyBjb2xvcjogJ3doaXRlJyB9XCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZGVsZXRlKT1cImRlbGV0ZSgpXCJcbiAgICAgICAgICAgICAgICAgICAgICAgID48L2phbS1kZWxldGUtY29uZmlybWF0aW9uPlxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbjwvamFtLXVwbG9hZD5cbmAsXG4gICAgc3R5bGVzOiBbYGphbS11cGxvYWQgI3BpY3R1cmUtbWFuYWdlciAqLGphbS11cGxvYWQgI3BpY3R1cmUtbWFuYWdlciAqPm1hdC1pY29ue3dpZHRoOmF1dG87aGVpZ2h0OmF1dG99LnNxdWFyZXtib3JkZXItcmFkaXVzOjIlO292ZXJmbG93OmhpZGRlbn0ucm91bmR7Ym9yZGVyLXJhZGl1czo1MCU7b3ZlcmZsb3c6aGlkZGVufS5yb3VuZC1kcmFnLWFuZC1kcm9wLXN0eWxlc3tiYWNrZ3JvdW5kLWNvbG9yOnJnYmEoMCwwLDAsLjA1KTtwb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxODBweDtoZWlnaHQ6MTgwcHg7dG9wOjA7bGVmdDowO3otaW5kZXg6MzMzO2JhY2tncm91bmQtaW1hZ2U6dXJsKC9hc3NldHMvaW1hZ2VzL2RyYWdfYW5kX2Ryb3AucG5nKTtib3JkZXItcmFkaXVzOjUwJX0uc3F1YXJlLWRyYWctYW5kLWRyb3Atc3R5bGVze2JhY2tncm91bmQtY29sb3I6cmdiYSgwLDAsMCwuMDUpO3Bvc2l0aW9uOnJlbGF0aXZlO3dpZHRoOjE4MHB4O2hlaWdodDoxODBweDt0b3A6MDtsZWZ0OjA7ei1pbmRleDozMzM7YmFja2dyb3VuZC1pbWFnZTp1cmwoL2Fzc2V0cy9pbWFnZXMvZHJhZ19hbmRfZHJvcC5wbmcpfWphbS11cGxvYWQgI3BpY3R1cmUtbWFuYWdlciAqPm1hdC1pY29ue2NvbG9yOiNmZmY7Zm9udC1zaXplOjQuNXJlbX1qYW0tdXBsb2FkICNwaWN0dXJlLW1hbmFnZXIubW91c2VvdmVyOmhvdmVye2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnR9amFtLXVwbG9hZCAjcGljdHVyZS1tYW5hZ2VyLm1vdXNlb3ZlciBkaXY+Lm1vdXNlb3Zlci1jaGlsZHtkaXNwbGF5Om5vbmU7LXdlYmtpdC10cmFuc2l0aW9uOmRpc3BsYXkgLjNzO3RyYW5zaXRpb246ZGlzcGxheSAuM3N9amFtLXVwbG9hZCAjcGljdHVyZS1tYW5hZ2VyLm1vdXNlb3Zlcjpob3ZlciBkaXY+Lm1vdXNlb3Zlci1jaGlsZHtkaXNwbGF5OmluaGVyaXR9amFtLXVwbG9hZCAjcGljdHVyZS1tYW5hZ2VyLm1vdXNlb3Zlcjpob3ZlciBkaXY+Lm1vdXNlb3Zlci1jaGlsZCAuYmx1cnt0b3A6MDtib3R0b206MDtsZWZ0OjA7cmlnaHQ6MDstd2Via2l0LWZpbHRlcjpibHVyKDEwcHgpOy1tb3otZmlsdGVyOmJsdXIoMTBweCk7LW1zLWZpbHRlcjpibHVyKDEwcHgpOy1vLWZpbHRlcjpibHVyKDEwcHgpO2ZpbHRlcjpibHVyKDEwcHgpO3dpZHRoOmNhbGMoMTAwJSArIDQwcHgpO2hlaWdodDpjYWxjKDEwMCUgKyA0MHB4KTtwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OjE7bWFyZ2luOi0yMHB4fWphbS11cGxvYWQgI3BpY3R1cmUtbWFuYWdlciBkaXYgbWF0LWRpdmlkZXJ7d2lkdGg6NjAlO3Bvc2l0aW9uOnJlbGF0aXZlO2JvcmRlci1jb2xvcjojZmZmfWphbS11cGxvYWQgI3BpY3R1cmUtbWFuYWdlciBkaXZ7d2lkdGg6MTgwcHg7aGVpZ2h0OjE4MHB4O3Bvc2l0aW9uOnJlbGF0aXZlO2JhY2tncm91bmQtc2l6ZTpjb3ZlcjtiYWNrZ3JvdW5kLXBvc2l0aW9uOmNlbnRlcn1qYW0tdXBsb2FkICNwaWN0dXJlLW1hbmFnZXIubW91c2VvdmVyIGRpdj4ubW91c2VvdmVyLWNoaWxkIC5tZW51e3otaW5kZXg6Mztwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MH1qYW0tdXBsb2FkICNwaWN0dXJlLW1hbmFnZXIgZGl2PmRpdi5vdmVybGF5e3RvcDowO2JvdHRvbTowO2xlZnQ6MDtyaWdodDowO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDoxO2JhY2tncm91bmQtY29sb3I6cmdiYSgwLDAsMCwuMzc2KX1gXVxufSlcbmV4cG9ydCBjbGFzcyBQaWN0dXJlTWFuYWdlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gICAgLyoqXG4gICAgICogSW5wdXRzXG4gICAgICogQHBhcmFtIHR5cGU6IGRlc2NyaWJlcyB0aGUgc2hhcGUgb2YgdGhlIGltYWdlIGNvbnRhaW5lciwgdGhpcyBwYXJhbWV0ZXIgaXMgb3B0aW9uYWwuLlxuICAgICAqIEBwYXJhbSBzb3VyY2U6IGlzIGEgdXJsIHRvIHJlZmVyZW5jZSBhbiBpbWFnZS5cbiAgICAgKiBAcGFyYW0gZGVsZXRlVXJsOiBpcyBhIHVybCBmb3IgZGVsZXRpbmcgYW4gaW1hZ2UsIHRoaXMgcGFyYW1ldGVyIGlzIG9wdGlvbmFsLlxuICAgICAqIEBwYXJhbSB1cGxvYWRVcmw6IGlzIGEgdXJsIGZvciB1cGxvYWRpbmcgYW4gaW1hZ2UsIHRoaXMgcGFyYW1ldGVyIGlzIG9wdGlvbmFsLlxuICAgICAqL1xuICAgIEBJbnB1dCgpIHB1YmxpYyB0eXBlOiAnc3F1YXJlJyB8ICdyb3VuZCc7XG4gICAgQElucHV0KCkgcHVibGljIHNvdXJjZTogc3RyaW5nO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBkZWxldGVVcmw6IHN0cmluZztcbiAgICBASW5wdXQoKSBwdWJsaWMgdXBsb2FkVXJsOiBzdHJpbmc7XG4gICAgQElucHV0KCkgcHVibGljIHNob3dEZWxldGVPcHRpb246IGJvb2xlYW4gPSB0cnVlO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBqYW1IZWFkZXJzOiB7IFtrZXk6IHN0cmluZ106IGFueSB9O1xuXG4gICAgLyoqXG4gICAgICogT3V0cHV0c1xuICAgICAqIEBwYXJhbSB1cGxvYWRDaGFuZ2U6IHVwZGF0ZXMgdGhlIGltYWdlIGFuZCByZXR1cm5zIHRoZSB1cmwgZm9yIGl0LlxuICAgICAqL1xuICAgIEBPdXRwdXQoKSBwdWJsaWMgdXBsb2FkQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxJbWFnZUNoYW5nZT4oKTtcbiAgICBAT3V0cHV0KCkgcHVibGljIHJlc3BvbnNlID0gbmV3IEV2ZW50RW1pdHRlcjxVcGxvYWRPdXRwdXQ+KCk7XG5cbiAgICBwdWJsaWMgZHJhZ19hbmRfZHJvcDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBodHRwQ2xpZW50OiBIdHRwQ2xpZW50KSB7fVxuXG4gICAgcHVibGljIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLnNldHRpbmdEZWZhdWx0VmFsdWVzKCk7XG4gICAgfVxuXG4gICAgcHVibGljIGRyYWdBbmREcm9wU3R5bGVzKGRyYWdfYW5kX2Ryb3A6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5kcmFnX2FuZF9kcm9wID0gZHJhZ19hbmRfZHJvcDtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2hvd1ByZXZpZXcoaW1hZ2U6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLnNvdXJjZSA9IGltYWdlO1xuICAgICAgICB0aGlzLmRlbGV0ZVVybCA9IHRoaXMuZGVsZXRlVXJsIHx8IHRoaXMuc291cmNlO1xuICAgICAgICB0aGlzLnVwbG9hZENoYW5nZS5lbWl0KHsgc3RhdHVzX2NoYW5nZTogJ3VwZGF0ZScsIHNvdXJjZTogdGhpcy5zb3VyY2UgfSk7XG4gICAgfVxuXG4gICAgcHVibGljIGRlbGV0ZSgpIHtcbiAgICAgICAgbGV0IGRlbGV0ZV91cmwgPSB0aGlzLmNyZWF0RGVsZXRlVXJsKHRoaXMuc291cmNlKTtcbiAgICAgICAgdGhpcy5odHRwQ2xpZW50LmRlbGV0ZShkZWxldGVfdXJsLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmphbUhlYWRlcnNcbiAgICAgICAgfSkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgKHJlc3BvbnNlKTogdm9pZCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGxvYWRDaGFuZ2UuZW1pdCh7IHN0YXR1c19jaGFuZ2U6ICdkZWxldGUnLCBzb3VyY2U6IHRoaXMuc291cmNlIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2V0dGluZ0RlZmF1bHRWYWx1ZXMoKSB7XG4gICAgICAgIHRoaXMudHlwZSA9IHRoaXMudHlwZSB8fCAnc3F1YXJlJztcbiAgICAgICAgdGhpcy5kZWxldGVVcmwgPSB0aGlzLmRlbGV0ZVVybCB8fCB0aGlzLnNvdXJjZTtcbiAgICAgICAgdGhpcy51cGxvYWRVcmwgPSB0aGlzLnVwbG9hZFVybCB8fCB0aGlzLnNvdXJjZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0RGVsZXRlVXJsKHNvdXJjZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IGltZ191cmxfcGFydGllczogQXJyYXk8c3RyaW5nPiA9IHNvdXJjZS5zcGxpdCgnLycpO1xuICAgICAgICBsZXQgaW1nX25hbWU6IHN0cmluZyA9IGltZ191cmxfcGFydGllcy5wb3AoKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5kZWxldGVVcmwgKyBpbWdfbmFtZTtcbiAgICB9XG59XG4iXX0=